!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("vue")):"function"==typeof define&&define.amd?define(["vue"],t):(e="undefined"!=typeof globalThis?globalThis:e||self)["vue-canvas-sign"]=t(e.Vue)}(this,(function(e){"use strict";var t=e.defineComponent({name:"CanvasSign",props:{width:{type:Number,default:document.documentElement.clientWidth||document.body.clientWidth},height:{type:Number,default:200},lineWidth:{type:Number,default:2},color:{type:String,default:"#000"},background:{type:String,default:"rgba(255, 255, 255, 0)"},borderWidth:{type:Number,default:1},borderColor:{type:String,default:"#333"},imageType:{type:String,default:"image/png",validator:e=>["image/png","image/jpeg","image/webp"].includes(e)},imageQual:{type:Number,default:.92,validator:e=>e<=1&&e>=0}},setup(t){const o=e.ref(),a=e.ref(),u=e.ref(!1),l=e.computed((()=>t.borderWidth>0&&t.width>2*t.borderWidth?`border: ${t.borderWidth}px solid ${t.borderColor}`:""));return e.onMounted((()=>{var e;const u=null==(e=o.value)?void 0:e.getContext("2d");if(u){const{background:e,width:o,height:l,color:n,lineWidth:r}=t;u.fillStyle=e,u.fillRect(0,0,o,l),u.strokeStyle=n,u.lineWidth=r,u.lineCap="round",u.lineJoin="round",u.shadowBlur=1,u.shadowColor=n,a.value=u}})),{canvas:o,borderStyle:l,save:e=>{if(!o.value)return void e();let a;a="image/jpeg"===t.imageType?o.value.toDataURL("image/jpeg",t.imageQual):o.value.toDataURL(t.imageType),e(a)},clear:()=>{var e;const{width:t,height:u}=o.value||{};null==(e=a.value)||e.clearRect(0,0,t||0,u||0)},touchstart:e=>{var t,o;const{pageX:u,pageY:l,target:n}=e.changedTouches[0],{tagName:r,offsetTop:d,offsetLeft:i}=n;"CANVAS"===r&&(null==(t=a.value)||t.beginPath(),null==(o=a.value)||o.moveTo(u-i,l-d))},mousedown:e=>{var t,o;const{tagName:l,offsetTop:n,offsetLeft:r}=e.target;"CANVAS"===l&&(u.value=!0,null==(t=a.value)||t.beginPath(),null==(o=a.value)||o.moveTo(e.pageX-r,e.pageY-n))},touchmove:e=>{if(e.stopPropagation(),e.preventDefault(),!a.value)return;const{pageX:t,pageY:o,target:u}=e.changedTouches[0],{tagName:l,offsetTop:n,offsetLeft:r}=u;"CANVAS"===l&&(a.value.lineTo(t-r,o-n),a.value.stroke())},mousemove:e=>{if(e.stopPropagation(),e.preventDefault(),u.value&&o.value&&a.value){const{tagName:l,offsetTop:n,offsetLeft:r}=e.target;if("CANVAS"===l){const{width:l,height:d}=o.value;a.value.lineTo(e.pageX-r,e.pageY-n),a.value.stroke(),(e.pageX-r<=t.borderWidth||e.pageX-r>=(l||0)-2*t.borderWidth||e.pageY-n<=t.borderWidth||e.pageY-n>=(d||0)-2*t.borderWidth)&&(u.value=!1)}}},touchend:()=>{var e;null==(e=a.value)||e.closePath()},mouseup:()=>{var e;u.value=!1,null==(e=a.value)||e.closePath()}}}});return t.render=function(t,o,a,u,l,n){return e.openBlock(),e.createBlock("div",null,[e.createVNode("canvas",{ref:"canvas",width:t.width>2*t.borderWidth?t.width-2*t.borderWidth:t.width,height:t.height,style:t.borderStyle,onTouchstart:o[1]||(o[1]=(...e)=>t.touchstart&&t.touchstart(...e)),onMousedown:o[2]||(o[2]=(...e)=>t.mousedown&&t.mousedown(...e)),onTouchmove:o[3]||(o[3]=(...e)=>t.touchmove&&t.touchmove(...e)),onMousemove:o[4]||(o[4]=(...e)=>t.mousemove&&t.mousemove(...e)),onTouchend:o[5]||(o[5]=(...e)=>t.touchend&&t.touchend(...e)),onMouseup:o[6]||(o[6]=(...e)=>t.mouseup&&t.mouseup(...e))},null,44,["width","height"]),e.renderSlot(t.$slots,"default",{save:t.save,clear:t.clear})])},t.install=e=>{e.component(t.name,t)},t}));
