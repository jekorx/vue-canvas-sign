import{d as e,r as t,c as a,o as l,a as o,b as n,e as u,f as r,g as i,F as c,w as d,h as s}from"./vendor.c1b75754.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(a){const l=new URL(e,location),o=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((a,n)=>{const u=new URL(e,l);if(self[t].moduleMap[u])return a(self[t].moduleMap[u]);const r=new Blob([`import * as m from '${u}';`,`${t}.moduleMap['${u}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(r),onerror(){n(new Error(`Failed to import: ${e}`)),o(i)},onload(){a(self[t].moduleMap[u]),o(i)}});document.head.appendChild(i)})),self[t].moduleMap={}}}("/vue-canvas-sign/assets/");var v=e({name:"CanvasSign",props:{width:{type:Number,default:document.documentElement.clientWidth||document.body.clientWidth},height:{type:Number,default:200},lineWidth:{type:Number,default:2},color:{type:String,default:"#000"},backgroundColor:{type:String,default:"rgba(255, 255, 255, 0)"},borderWidth:{type:Number,default:1},borderColor:{type:String,default:"#333"},imageType:{type:String,default:"image/png",validator:e=>["image/png","image/jpeg","image/webp"].includes(e)},imageQual:{type:Number,default:.92,validator:e=>e<=1&&e>=0}},setup(e){const o=t(),n=t(),u=t(!1),r=a((()=>e.borderWidth>0&&e.width>2*e.borderWidth?`border: ${e.borderWidth}px solid ${e.borderColor}`:""));return l((()=>{var t;const a=null==(t=o.value)?void 0:t.getContext("2d");if(a){const{backgroundColor:t,width:l,height:o,color:u,lineWidth:r}=e;a.fillStyle=t,a.fillRect(0,0,l,o),a.strokeStyle=u,a.lineWidth=r,a.lineCap="round",a.lineJoin="round",a.shadowBlur=1,a.shadowColor=u,n.value=a}})),{canvas:o,borderStyle:r,save:t=>{if(!o.value)return void t();let a;a="image/jpeg"===e.imageType?o.value.toDataURL("image/jpeg",e.imageQual):o.value.toDataURL(e.imageType),t(a)},clear:()=>{const{backgroundColor:t}=e,{width:a,height:l}=o.value||{};n.value&&(n.value.clearRect(0,0,a||0,l||0),n.value.fillStyle=t,n.value.fillRect(0,0,a||0,l||0))},touchstart:e=>{var t,a,l;const{clientX:u,clientY:r,target:i}=e.changedTouches[0];if("CANVAS"===i.tagName){const{left:e,top:i}=(null==(t=o.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};null==(a=n.value)||a.beginPath(),null==(l=n.value)||l.moveTo(u-e,r-i)}},mousedown:e=>{var t,a,l;if("CANVAS"===e.target.tagName){const{left:r,top:i}=(null==(t=o.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};u.value=!0,null==(a=n.value)||a.beginPath(),null==(l=n.value)||l.moveTo(e.clientX-r,e.clientY-i)}},touchmove:e=>{var t;if(e.stopPropagation(),e.preventDefault(),!n.value)return;const{clientX:a,clientY:l,target:u}=e.changedTouches[0];if("CANVAS"===u.tagName){const{left:e,top:u}=(null==(t=o.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};n.value.lineTo(a-e,l-u),n.value.stroke()}},mousemove:t=>{if(t.stopPropagation(),t.preventDefault(),u.value&&o.value&&n.value&&"CANVAS"===t.target.tagName){const{width:a,height:l}=o.value,{left:r,top:i}=o.value.getBoundingClientRect()||{left:0,top:0};n.value.lineTo(t.clientX-r,t.clientY-i),n.value.stroke(),(t.clientX-r<=e.borderWidth||t.clientX-r>=(a||0)-2*e.borderWidth||t.clientY-i<=e.borderWidth||t.clientY-i>=(l||0)-2*e.borderWidth)&&(u.value=!1)}},touchend:()=>{var e;null==(e=n.value)||e.closePath()},mouseup:()=>{var e;u.value=!1,null==(e=n.value)||e.closePath()}}}});v.render=function(e,t,a,l,i,c){return r(),o("div",null,[n("canvas",{ref:"canvas",width:e.width>2*e.borderWidth?e.width-2*e.borderWidth:e.width,height:e.height,style:e.borderStyle,onTouchstart:t[1]||(t[1]=(...t)=>e.touchstart&&e.touchstart(...t)),onMousedown:t[2]||(t[2]=(...t)=>e.mousedown&&e.mousedown(...t)),onTouchmove:t[3]||(t[3]=(...t)=>e.touchmove&&e.touchmove(...t)),onMousemove:t[4]||(t[4]=(...t)=>e.mousemove&&e.mousemove(...t)),onTouchend:t[5]||(t[5]=(...t)=>e.touchend&&e.touchend(...t)),onMouseup:t[6]||(t[6]=(...t)=>e.mouseup&&e.mouseup(...t))},null,44,["width","height"]),u(e.$slots,"default",{save:e.save,clear:e.clear})])},v.install=e=>{e.component(v.name,v)};const g="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";var m=e({components:{CanvasSign:v},setup(){const e=t(g),a=t();return{canvasSign:a,imgSrc:e,saveCallback:t=>{e.value=t||g},saveHandle:()=>{var t;null==(t=a.value)||t.save((t=>{e.value=t||g}))},clearHandle:()=>{var t;null==(t=a.value)||t.clear(),e.value=g},clearWithSlotHandle:t=>{t&&t(),e.value=g}}}});const h=n("hr",null,null,-1),p=n("hr",null,null,-1);m.render=function(e,t,a,l,u,s){const v=i("CanvasSign");return r(),o(c,null,[n(v,{ref:"canvasSign",imageType:"image/png",imageQual:.01,"background-color":"#CCC"},null,8,["imageQual"]),n("div",null,[n("button",{onClick:t[1]||(t[1]=(...t)=>e.saveHandle&&e.saveHandle(...t))},"save"),n("button",{onClick:t[2]||(t[2]=(...t)=>e.clearHandle&&e.clearHandle(...t))},"clear")]),h,n(v,{height:400},{default:d((({save:t,clear:a})=>[n("button",{onClick:()=>t(e.saveCallback)},"save",8,["onClick"]),n("button",{onClick:()=>e.clearWithSlotHandle(a)},"clear",8,["onClick"])])),_:1}),p,n("img",{src:e.imgSrc,alt:"生成的图片"},null,8,["src"])],64)};const f=s(m);f.component("CanvasSign",v),f.mount("#app");
