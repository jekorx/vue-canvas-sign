import{d as e,r as t,c as l,o as a,a as n,b as o,e as i,f as u,g as r,F as d,w as c,h as s}from"./vendor.c1b75754.js";!function(e=".",t="__import__"){try{self[t]=new Function("u","return import(u)")}catch(l){const a=new URL(e,location),n=e=>{URL.revokeObjectURL(e.src),e.remove()};self[t]=e=>new Promise(((l,o)=>{const i=new URL(e,a);if(self[t].moduleMap[i])return l(self[t].moduleMap[i]);const u=new Blob([`import * as m from '${i}';`,`${t}.moduleMap['${i}']=m;`],{type:"text/javascript"}),r=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(u),onerror(){o(new Error(`Failed to import: ${e}`)),n(r)},onload(){l(self[t].moduleMap[i]),n(r)}});document.head.appendChild(r)})),self[t].moduleMap={}}}("/vue-canvas-sign/assets/");var v=e({name:"CanvasSign",props:{width:{type:Number,default:document.documentElement.clientWidth||document.body.clientWidth},height:{type:Number,default:200},lineWidth:{type:Number,default:2},color:{type:String,default:"#000"},backgroundColor:{type:String,default:"rgba(255, 255, 255, 0)"},borderWidth:{type:Number,default:1},borderColor:{type:String,default:"#333"},imageType:{type:String,default:"image/png",validator:e=>["image/png","image/jpeg","image/webp"].includes(e)},imageQual:{type:Number,default:.92,validator:e=>e<=1&&e>=0}},setup(e){const n=t(),o=t(),i=t(!1),u=l((()=>e.borderWidth>0&&e.width>2*e.borderWidth?`border: ${e.borderWidth}px solid ${e.borderColor}`:"")),r=()=>{const t=o.value;if(t){const{backgroundColor:l,color:a,lineWidth:o}=e,{width:i,height:u}=n.value||{};t.fillStyle=l,t.fillRect(0,0,i||0,u||0),t.strokeStyle=a,t.lineWidth=o,t.lineCap="round",t.lineJoin="round",t.shadowBlur=1,t.shadowColor=a}};return a((()=>{var e;const t=null==(e=n.value)?void 0:e.getContext("2d");t&&(o.value=t,r())})),{canvas:n,borderStyle:u,save:t=>{if(!n.value)return void t();let l;l="image/jpeg"===e.imageType?n.value.toDataURL("image/jpeg",e.imageQual):n.value.toDataURL(e.imageType),t(l)},clear:()=>{const{backgroundColor:t}=e,{width:l,height:a}=n.value||{};o.value&&(o.value.clearRect(0,0,l||0,a||0),o.value.fillStyle=t,o.value.fillRect(0,0,l||0,a||0))},reset:()=>{const t=o.value;if(t){const{width:l,height:a,borderWidth:n}=e;t.canvas.width=l>2*n?l-2*n:l,t.canvas.height=a,setTimeout(r,0)}},touchstart:e=>{var t,l,a;const{clientX:i,clientY:u,target:r}=e.changedTouches[0];if("CANVAS"===r.tagName){const{left:e,top:r}=(null==(t=n.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};null==(l=o.value)||l.beginPath(),null==(a=o.value)||a.moveTo(i-e,u-r)}},mousedown:e=>{var t,l,a;if("CANVAS"===e.target.tagName){const{left:u,top:r}=(null==(t=n.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};i.value=!0,null==(l=o.value)||l.beginPath(),null==(a=o.value)||a.moveTo(e.clientX-u,e.clientY-r)}},touchmove:e=>{var t;if(e.stopPropagation(),e.preventDefault(),!o.value)return;const{clientX:l,clientY:a,target:i}=e.changedTouches[0];if("CANVAS"===i.tagName){const{left:e,top:i}=(null==(t=n.value)?void 0:t.getBoundingClientRect())||{left:0,top:0};o.value.lineTo(l-e,a-i),o.value.stroke()}},mousemove:t=>{if(t.stopPropagation(),t.preventDefault(),i.value&&n.value&&o.value&&"CANVAS"===t.target.tagName){const{width:l,height:a}=n.value,{left:u,top:r}=n.value.getBoundingClientRect()||{left:0,top:0};o.value.lineTo(t.clientX-u,t.clientY-r),o.value.stroke(),(t.clientX-u<=e.borderWidth||t.clientX-u>=(l||0)-2*e.borderWidth||t.clientY-r<=e.borderWidth||t.clientY-r>=(a||0)-2*e.borderWidth)&&(i.value=!1)}},touchend:()=>{var e;null==(e=o.value)||e.closePath()},mouseup:()=>{var e;i.value=!1,null==(e=o.value)||e.closePath()}}}});v.render=function(e,t,l,a,r,d){return u(),n("div",null,[o("canvas",{ref:"canvas",width:e.width>2*e.borderWidth?e.width-2*e.borderWidth:e.width,height:e.height,style:e.borderStyle,onTouchstart:t[1]||(t[1]=(...t)=>e.touchstart&&e.touchstart(...t)),onMousedown:t[2]||(t[2]=(...t)=>e.mousedown&&e.mousedown(...t)),onTouchmove:t[3]||(t[3]=(...t)=>e.touchmove&&e.touchmove(...t)),onMousemove:t[4]||(t[4]=(...t)=>e.mousemove&&e.mousemove(...t)),onTouchend:t[5]||(t[5]=(...t)=>e.touchend&&e.touchend(...t)),onMouseup:t[6]||(t[6]=(...t)=>e.mouseup&&e.mouseup(...t))},null,44,["width","height"]),i(e.$slots,"default",{save:e.save,clear:e.clear})])},v.install=e=>{e.component(v.name,v)};const h="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";var m=e({components:{CanvasSign:v},setup(){const e=t(h),l=t(),n=t(document.documentElement.clientWidth||document.body.clientWidth),o=t(10);return a((()=>{window.onresize=()=>{var e;const t=document.documentElement.clientWidth||document.body.clientWidth;n.value=t,o.value=t/100,null==(e=l.value)||e.reset()}})),{width:n,lineWidth:o,canvasSign:l,imgSrc:e,saveCallback:t=>{e.value=t||h},saveHandle:()=>{var t;null==(t=l.value)||t.save((t=>{e.value=t||h}))},clearHandle:()=>{var t;null==(t=l.value)||t.clear(),e.value=h},clearWithSlotHandle:t=>{t&&t(),e.value=h}}}});const g=o("hr",null,null,-1),p=o("hr",null,null,-1);m.render=function(e,t,l,a,i,s){const v=r("CanvasSign");return u(),n(d,null,[o(v,{ref:"canvasSign",imageType:"image/png",width:e.width,"line-width":e.lineWidth,"image-qual":.01,"background-color":"#EEE"},null,8,["width","line-width","image-qual"]),o("div",null,[o("button",{onClick:t[1]||(t[1]=(...t)=>e.saveHandle&&e.saveHandle(...t))},"save"),o("button",{onClick:t[2]||(t[2]=(...t)=>e.clearHandle&&e.clearHandle(...t))},"clear")]),g,o(v,{height:400,width:e.width,"line-width":e.lineWidth},{default:c((({save:t,clear:l})=>[o("button",{onClick:()=>t(e.saveCallback)},"save",8,["onClick"]),o("button",{onClick:()=>e.clearWithSlotHandle(l)},"clear",8,["onClick"])])),_:1},8,["width","line-width"]),p,o("img",{src:e.imgSrc,alt:"生成的图片"},null,8,["src"])],64)};const f=s(m);f.component("CanvasSign",v),f.mount("#app");
