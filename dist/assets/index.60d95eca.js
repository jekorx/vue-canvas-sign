import{d as e,r as a,c as t,o,a as l,b as n,e as r,f as u,g as i,w as s,h as d}from"./vendor.5609eb6f.js";!function(e=".",a="__import__"){try{self[a]=new Function("u","return import(u)")}catch(t){const o=new URL(e,location),l=e=>{URL.revokeObjectURL(e.src),e.remove()};self[a]=e=>new Promise(((t,n)=>{const r=new URL(e,o);if(self[a].moduleMap[r])return t(self[a].moduleMap[r]);const u=new Blob([`import * as m from '${r}';`,`${a}.moduleMap['${r}']=m;`],{type:"text/javascript"}),i=Object.assign(document.createElement("script"),{type:"module",src:URL.createObjectURL(u),onerror(){n(new Error(`Failed to import: ${e}`)),l(i)},onload(){t(self[a].moduleMap[r]),l(i)}});document.head.appendChild(i)})),self[a].moduleMap={}}}("/vue-canvas-sign/assets/");var c=e({name:"CanvasSign",props:{width:{type:Number,default:document.documentElement.clientWidth||document.body.clientWidth},height:{type:Number,default:200},lineWidth:{type:Number,default:2},color:{type:String,default:"#000"},background:{type:String,default:"rgba(255, 255, 255, 0)"},borderWidth:{type:Number,default:1},borderColor:{type:String,default:"#333"},imageType:{type:String,default:"image/png",validator:e=>["image/png","image/jpeg","image/webp"].includes(e)},imageQual:{type:Number,default:.92,validator:e=>e<=1&&e>=0}},setup(e){const l=a(),n=a(),r=a(!1),u=t((()=>e.borderWidth>0&&e.width>2*e.borderWidth?`border: ${e.borderWidth}px solid ${e.borderColor}`:""));return o((()=>{var a;const t=null==(a=l.value)?void 0:a.getContext("2d");if(t){const{background:a,width:o,height:l,color:r,lineWidth:u}=e;t.fillStyle=a,t.fillRect(0,0,o,l),t.strokeStyle=r,t.lineWidth=u,t.lineCap="round",t.lineJoin="round",t.shadowBlur=1,t.shadowColor=r,n.value=t}})),{canvas:l,borderStyle:u,save:a=>{if(!l.value)return void a();let t;t="image/jpeg"===e.imageType?l.value.toDataURL("image/jpeg",e.imageQual):l.value.toDataURL(e.imageType),a(t)},clear:()=>{var e;const{width:a,height:t}=l.value||{};null==(e=n.value)||e.clearRect(0,0,a||0,t||0)},touchstart:e=>{var a,t;const{pageX:o,pageY:l,target:r}=e.changedTouches[0],{tagName:u,offsetTop:i,offsetLeft:s}=r;"CANVAS"===u&&(null==(a=n.value)||a.beginPath(),null==(t=n.value)||t.moveTo(o-s,l-i))},mousedown:e=>{var a,t;const{tagName:o,offsetTop:l,offsetLeft:u}=e.target;"CANVAS"===o&&(r.value=!0,null==(a=n.value)||a.beginPath(),null==(t=n.value)||t.moveTo(e.pageX-u,e.pageY-l))},touchmove:e=>{if(e.stopPropagation(),e.preventDefault(),!n.value)return;const{pageX:a,pageY:t,target:o}=e.changedTouches[0],{tagName:l,offsetTop:r,offsetLeft:u}=o;"CANVAS"===l&&(n.value.lineTo(a-u,t-r),n.value.stroke())},mousemove:a=>{if(a.stopPropagation(),a.preventDefault(),r.value&&l.value&&n.value){const{tagName:t,offsetTop:o,offsetLeft:u}=a.target;if("CANVAS"===t){const{width:t,height:i}=l.value;n.value.lineTo(a.pageX-u,a.pageY-o),n.value.stroke(),(a.pageX-u<=e.borderWidth||a.pageX-u>=(t||0)-2*e.borderWidth||a.pageY-o<=e.borderWidth||a.pageY-o>=(i||0)-2*e.borderWidth)&&(r.value=!1)}}},touchend:()=>{var e;null==(e=n.value)||e.closePath()},mouseup:()=>{var e;r.value=!1,null==(e=n.value)||e.closePath()}}}});c.render=function(e,a,t,o,i,s){return u(),l("div",null,[n("canvas",{ref:"canvas",width:e.width>2*e.borderWidth?e.width-2*e.borderWidth:e.width,height:e.height,style:e.borderStyle,onTouchstart:a[1]||(a[1]=(...a)=>e.touchstart&&e.touchstart(...a)),onMousedown:a[2]||(a[2]=(...a)=>e.mousedown&&e.mousedown(...a)),onTouchmove:a[3]||(a[3]=(...a)=>e.touchmove&&e.touchmove(...a)),onMousemove:a[4]||(a[4]=(...a)=>e.mousemove&&e.mousemove(...a)),onTouchend:a[5]||(a[5]=(...a)=>e.touchend&&e.touchend(...a)),onMouseup:a[6]||(a[6]=(...a)=>e.mouseup&&e.mouseup(...a))},null,44,["width","height"]),r(e.$slots,"default",{save:e.save,clear:e.clear})])},c.install=e=>{e.component(c.name,c)};const v="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";var g=e({components:{CanvasSign:c},setup(){const e=a(v),t=a();return{canvasSign:t,imgSrc:e,saveCallback:a=>{e.value=a||v},saveHandle:()=>{var a;null==(a=t.value)||a.save((a=>{e.value=a||v}))},clearHandle:()=>{var a;null==(a=t.value)||a.clear(),e.value=v},clearWithSlotHandle:a=>{a&&a(),e.value=v}}}});const m=n("hr",null,null,-1),p=n("hr",null,null,-1);g.render=function(e,a,t,o,r,d){const c=i("CanvasSign");return u(),l("div",null,[n(c,{ref:"canvasSign",imageType:"image/png",imageQual:.01,background:"#FFF"},null,8,["imageQual"]),n("div",null,[n("button",{onClick:a[1]||(a[1]=(...a)=>e.saveHandle&&e.saveHandle(...a))},"save"),n("button",{onClick:a[2]||(a[2]=(...a)=>e.clearHandle&&e.clearHandle(...a))},"clear")]),m,n(c,null,{default:s((({save:a,clear:t})=>[n("button",{onClick:()=>a(e.saveCallback)},"save",8,["onClick"]),n("button",{onClick:()=>e.clearWithSlotHandle(t)},"clear",8,["onClick"])])),_:1}),p,n("img",{src:e.imgSrc,alt:"生成的图片"},null,8,["src"])])};const h=d(g);h.component("CanvasSign",c),h.mount("#app");
